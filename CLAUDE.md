# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Peak Tracker is a mobile-first Progressive Web App (PWA) for tracking workouts with wave-loaded periodization (Garage Strength / Peak Strength style). It's a **zero-build static site** — no bundler, no package manager, no build step.

## Development

**Serving locally:** Use any static file server from the repo root:
```
python3 -m http.server 8000
# or
npx serve .
```

There is no build command, no test suite, and no linter. The app runs directly in the browser.

**Deploying:** Push to `main` — GitHub Pages serves from the repo root.

## Architecture

The entire app lives in **`index.html`** as a single inline `<script type="text/babel">` block. React 18, ReactDOM, Recharts, and Babel standalone are loaded from unpkg CDN. Babel transpiles JSX in the browser at runtime.

### Single-component structure

Everything is in one `App()` component (~330 lines) with ~15 `useState` hooks. There is no routing, no component tree, and no external CSS — all styles are inline objects.

### Key variable naming convention

State variables use abbreviated names throughout (e.g., `cDay` = current day, `cWeek` = current week, `bNum` = block number, `logD` = log data, `maxO` = max overrides, `compS` = completed sets). Helper functions follow the same pattern: `glk` = get log key, `gEM` = get effective max, `gCP` = get completion percentage, `gLH` = get lift history, `gALE` = get all lifts e1RM.

### Data model

- **`PROGRAM`** — static config defining 4 training days, each with exercises. Wave exercises (`isWave: true`) have percentage-based periodization across 4 weeks (3 working + 1 deload). Non-wave exercises have fixed sets/reps/weight.
- **`CC`** — category color map for exercise types: `tech`, `absolute`, `ss` (superset), `acc` (accessory).
- All user data is persisted to `localStorage` under key `peak-tracker-v2` as a single JSON blob containing: `currentDay`, `currentWeek`, `blockNum`, `logData`, `maxOverrides`, `completedSets`, `workoutNotes`, `exerciseNotes`.

### Key domain logic

- **Wave sets** are generated by `getWS()` — takes a wave config, week index, and current max, returns warmup + working sets with calculated weights (rounded to nearest 5 via `r5()`).
- **e1RM calculation** uses Epley formula in `eMax()`: `weight * (1 + reps/30)`.
- **Block advancement** (`advW`): when advancing past week 4, auto-recalculates training maxes from week 3 logged data, picking the best e1RM or adding 5 lb if no improvement.
- **Main lifts** tracked in charts: bench, squat, deadlift, OHP (defined in `ML` array).

### Service worker (`sw.js`)

Cache-first for local assets, network-first with cache fallback for CDN resources. Cache name: `peak-tracker-v1`. Bump this when updating cached assets.

## Modifying the program

To change exercises, training maxes, wave percentages, or day structure, edit the `PROGRAM` object near the top of the script block in `index.html`. Category colors are in `CC`.
